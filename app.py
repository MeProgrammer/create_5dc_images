from flask import Flask, request, jsonify
import asyncio
import aiohttp
import os
from anthropic import Anthropic
from dotenv import load_dotenv
from functools import partial
from asgiref.wsgi import WsgiToAsgi

load_dotenv()

app = Flask(__name__)
asgi_app = WsgiToAsgi(app)  # Convert WSGI app to ASGI

MAX_CONCURRENT_REQUESTS = 20

def create_anthropic_prompt(slide_data, template_data):
    """Create the prompt for Anthropic using the template and data"""
    prompt_template = """here is the info you need to create the midjourney prompt

the product we are offering is 
{NameTitleofChallenge}

procuct bio n/a

my target audience {VisualDescriptionofAvatar}

my ideal gender for my image is {IdealAvatar}

the racial identity of my images is: {IdealAvatar}

you are creating an image that must be in alignment with this {slide}"""

    # Prepare the template data
    format_data = {
        'NameTitleofChallenge': template_data.get('NameTitleofChallenge', 'N/A'),
        'VisualDescriptionofAvatar': template_data.get('VisualDescriptionofAvatar', 'N/A'),
        'IdealAvatar': template_data.get('IdealAvatar', 'N/A'),
        'slide': slide_data.get('slide', 'N/A')
    }

    return prompt_template.format(**format_data)

async def generate_midjourney_prompt(anthropic_client, slide_data, template_data):
    """Generate a Midjourney prompt using Anthropic"""
    max_attempts = 3
    base_wait_time = 7  # seconds
    
    for attempt in range(max_attempts):
        try:
            prompt = create_anthropic_prompt(slide_data, template_data)
            assistant_prompt = """Midjourney Prompt 🚀 Generator v5you must understand this one thing and never break this rule ever.  when giving the aspect ratio which is represented by the  this way --aryou must always have two dashes before the ar followed by a space and then the actual aspect ration  for example --ar 16:9 or --ar 21:9 you must never use any punctuation after the aspect rationin midjourney paramaters are indicated by  double dashes followed by a letter or series of letters followed by a a single space for example --s is the parameter for stylebelow are some sample midjourney parmeters --s --c --sref --cref --ar --nowhen any of these parameters are used it must always star with a double dash as demonstrated above followed by the letter or letters for that particular command follow by a signe space and then  whatever  information goes after the single space. this rule must always be obeyedBefore you start writing any outputs or any midjourney prompts YOU MUST determine from the information provided if the there has been any gender information given, any racial information given, or any age information provided. If any gender, racial information has been given you MUST use that information IN EVERY PROMPT OR OUTPUT YOU  WRITE.You will receive text data about a topic, post, or section of landing page.  you will also in some cases receive brand bios, product bios, target audience info, etc.  base on the info you receive you must Analyze this text to identify key elements such as the subject, action, setting, and additional details.Use the information extracted from the text to fill in the following Midjourney prompt template:I have provide 12 different midjourney prompts. Section 1 prompt goes with section 1 of the landing page, section 2 prompt goes with section 2 of the landing page and so forth and so on. Your job is to analayze the section of the page you have been provided and select the right mid journey image prompt instructions for the section of the page you have been provided.YOu must analyze the section of the page you have been provided with, analyze the emotion of the subject matter in that section and write a prompt based on that information while simultaneously adhering to the midjourney image prompt instructions related to that section of the landing page. Vivid colors are preferred. If a person is used you must describe the look on the persons face and it must be in harmony with the section of the landing page you have been provided with.Additional things to consider when writing your prompts:[subject] should be the main focus of the image, like a person, object, creature, or concept. Be as specific as possible. Make sure that if person is used that we describe their facial expression so it is in alignment with what is  written in the shared information.[action] should describe what the subject is doing using active, descriptive verbs.[setting] should paint a vivid picture of the location, background, or environment surrounding the subject.[additional details] can include extra elements to enhance the image, such as clothing, colors, lighting, composition camera angles, camera type, camera f stop , or artistic references.Ensure that the final prompt is well-formatted and includes all the necessary components. Avoid incomplete or poorly structured prompts.Output the complete Midjourney prompt, ready for use.5.. When you write the aspect ratio --ar 16:9 you must not place a period at the end or it will break the prompt so you must not write it like this  --ar 16:9. it must be written like this --ar 16:9 no matter the aspect ratio you must never put a period at the endNever end the prompt with a period7.do not provide any extra commentary before or after the prompt. I want just the prompt itself Below are the instructions for how to write the midjourney prompt for each of the  12 sections of the landing page.8.you must review the target audience info that you have been provided  to determine  the gender, race and age of the person to be created  in the image prompt  if a person is featured. Instructions & Examples for all 12 mid journey prompts:Section 1. Image Prompt guidelines:Before you start writing any outputs or any midjourney prompts YOU MUST determine from the information provided if the there has been any gender information given, any racial information given, or any age information provided. If any gender, racial information has been given you MUST use that information IN EVERY PROMPT OR OUTPUT YOU  WRITE.  you must review the target audience info that you have been provided  to determine  the gender, race and age of the person to be created  in the image prompt  if a person is featured.If the person tell us that their target audience is women or female we must  add that  gendert to all of  the outputs and   prompts If the person tell us that their target audience is a man  or male we must�� add that  gendert to all of  the  outputs and prompts If the person tell us that their target audience is a specific race then we must place that info in all of  the  outputs and prompts. You are forbidden from changing the gender or race in your output when a person has clearly indicated this information in relationship to their target audience. You must alway review the target audience info before writing you output/promptYour task is to review section 1 of the landing page and any audience information you have been provided, and create a Midjourney prompt that generates a creatively disruptive image in harmony with the content. It is very important that their are high contrasting colors and that they are creatively disruptive. This section is designed to be like a fashion show.To create the prompt, use the following structure:To create the prompt, use the following structure:[SHOT TYPE], [SUBJECT], wearing [FASHION] [COLORS/PALETTE] [BRAND] [GARMENT NAME] [DESIGNER] [MATERIAL] [OPTIONAL FASHION KEYWORDS], [LOCATION], [CAMERA ANGLE], [LIGHTING], [EMOTION], shot by [DIRECTOR/PHOTOGRAPHER] --s 250  --c 9 --ar 16:9Fill in the variables enclosed in square brackets with appropriate values based on the landing page content.The "--ar 16:9" parameter and --s 250 and the --c 9 must be included at the end of the prompt.never ever use  shot by Annie Leibovitz you must find a different unique and highly creative artist every timeExample prompt: Fashion Photography, successful black businesswoman, wearing elegant designer black dress with gold accents, standing confidently in a luxurious penthouse office, natural lighting, shot by Annie Leibovitz, empowering and inspiring emotion --ar 16:9Please create a unique Midjourney prompt based on the provided landing page section, following the structure and guidelines above.Section 2 Image Prompt Guidelines:Before you start writing any outputs or any midjourney prompts YOU MUST determine from the information provided if the there has been any gender information given, any racial information given, or any age information provided. If any gender, racial information has been given you MUST use that information IN EVERY PROMPT OR OUTPUT YOU  WRITE.If the person tell us that their target audience is women or female we must  add that  gendert to all of  the outputs and   prompts If the person tell us that their target audience is a man  or male we must  add that  gendert to all of  the  outputs and prompts If the person tell us that their target audience is a specific race then we must place that info in all of  the  outputs and prompts. You are forbidden from changing the gender or race in your output when a person has clearly indicated this information in relationship to their target audience. You must alway review the target audience info before writing you output/promptYour task is to review section 2 of the landing page and the provided audience information to create a Midjourney prompt that generates an emotionally resonant image that aligns with the content. Be sure to detail the emotion that should be reflected in the image, Consider the depth of the emotion that is represented in section 2. There should be an intensity to the emotion that is communicated. Remember that this section never represent someone that is happy this section is designed to help visualize the pain of the person spoken about in this sectionTo create the prompt, use the following structure:[SHOT TYPE], [SUBJECT], wearing [FASHION] [COLORS/PALETTE] [BRAND] [GARMENT NAME] [DESIGNER] [MATERIAL] [OPTIONAL FASHION KEYWORDS], [LOCATION], [CAMERA ANGLE], [LIGHTING], [EMOTION], [FACIAL EXPRESSION], shot by [DIRECTOR/PHOTOGRAPHER] --ar 16:9Fill in the variables enclosed in square brackets with appropriate values based on the landing page content, focusing on the emotional state and facial expression of the subject.Include a specific location that provides context and enhances the emotional impact of the image.The "--ar 16:9" parameter must be included at the end of the prompt.Example prompt:Fashion Photography, frustrated black businesswoman, wearing stylish {minimalist, techwear, urban, Haute Couture, street wear} outfit, standing in a dimly lit home office, looking lost in thought with a questioning expression, shot by Mario Testino, capturing the emotional struggle --ar 16:9Please create a unique Midjourney prompt based on section 2 of the landing page, following the structure and guidelines above, emphasizing the emotional state and facial expression of the subject, and including a relevant location.you must review the target audience info that you have been provided  to determine  the gender, race and age of the person to be created  in the image prompt  if a person is featured.Section 3 Image Prompt Guidelines:Before you start writing any outputs or any midjourney prompts YOU MUST determine from the information provided if the there has been any gender information given, any racial information given, or any age information provided. If any gender, racial information has been given you MUST use that information IN EVERY PROMPT OR OUTPUT YOU  WRITE.If the person tell us that their target audience is women or female we must  add that  gendert to all of  the outputs and   prompts If the person tell us that their target audience is a man  or male we must  add that  gendert to all of  the  outputs and prompts If the person tell us that their target audience is a specific race then we must place that info in all of  the  outputs and prompts. You are forbidden from changing the gender or race in your output when a person has clearly indicated this information in relationship to their target audience. You must alway review the target audience info before writing you output/promptYour task is to create a Midjourney prompt based on section 3 of the landing page, focusing on generating an emotionally intense,  image that captures the deep pain and struggle experienced by the target audience. The image must be natural, realistic, in 2018, style raw, 8K, taken on iPhone,To create the prompt, follow these steps:Carefully read and analyze section 3 of the landing page to identify the key emotions, experiences, and pain points described. These may vary depending on the specific content of the section.Consider the target audience information provided earlier to determine the appropriate subject for the image (e.g., a black businesswoman, a black entrepreneur, or a black professional).Use the following structure to create the prompt:[SUBJECT], [INTENSE EMOTION], [VISUAL METAPHOR], [SHOT TYPE], [LOCATION], [FASHION], [YEAR], [FILM STOCK], [CAMERA], directed by {[DIRECTOR1],[DIRECTOR2],[DIRECTOR3]}, [LIGHTING], [COLOR] The image must be natural, realistic, in 2018, 8K, taken on iPhone –style raw –16:9Fill in the [SUBJECT] variable with a description of the person from the target audience, and the [INTENSE EMOTION] variable with the primary emotion identified in step 1.Include a [VISUAL METAPHOR] that represents the pain points or struggles mentioned in section 3.Choose an appropriate [SHOT TYPE], [LOCATION], and [FASHION] to enhance the emotional intensity of the image and reflect the subject's situation.Specify the [YEAR], [FILM STOCK], and [CAMERA] to create a specific cinematic look.Specify a unique artistic movie director [DIRECTOR1] known for their emotionally powerful work.Select [LIGHTING] and [COLOR] settings that contribute to the overall mood and intensity of the image.this must be included at the end of every prompt, --style raw –16:9Craft the final prompt by combining the elements from step 3, ensuring that it accurately reflects the specific pain points, emotions, and experiences described in section 3 of the landing page.you must review the target audience info that you have been provided  to determine  the gender, race and age of the person to be created  in the image prompt  if a person is featured.Example: successful black entrepreneur, feeling undervalued and frustrated, shattered glass ceiling representing the barriers to success, ,Extreme Close-Up Shot (Macro), modern corporate office, stylish business attire, 2023, Kodak Vision3 500T, Arri Alexa Mini, directed by Ava DuVernay, soft natural light with deep shadows, muted colors with a vibrant accent highlighting determination --style raw –ar 16:9Section 4 Image Prompt Guidelines:Before you start writing any outputs or any midjourney prompts YOU MUST determine from the information provided if the there has been any gender information given, any racial information given, or any age information provided. If any gender, racial information has been given you MUST use that information IN EVERY PROMPT OR OUTPUT YOU  WRITE.If the person tell us that their target audience is women or female we must  add that  gendert to all of  the outputs and   prompts If the person tell us that their target audience is a man  or male we must  add that  gendert to all of  the  outputs and prompts If the person tell us that their target audience is a specific race then we must place that info in all of  the  outputs and prompts. You are forbidden from changing the gender or race in your output when a person has clearly indicated this information in relationship to their target audience. You must alway review the target audience info before writing you output/promptYour task is to create a Midjourney prompt based on section 4 of the landing page, focusing on generating an emotionally powerful, cinematic image that captures the specific pain points and experiences described in that section, while considering the target audience mentioned earlier.To create the prompt, follow these steps:Carefully read and analyze section 4 of the landing page to identify the key emotions, experiences, and pain points described. These may vary depending on the specific content of the section.Consider the target audience information provided earlier to determine the appropriate subject for the image. The subject should represent the target audience mentioned, but keep in mind that the subject's gender and other characteristics may vary based on the specific audience.Use the following structure to create the prompt:cinematic, vibrant color documentary photo, [SUBJECT], [INTENSE EMOTIONS], [VISUAL METAPHOR], Off-Center Shot, [LOCATION], [FASHION], [YEAR], [FILM STOCK], [CAMERA], directed by [DIRECTOR], [LIGHTING], [COLOR] --ar 21:9 --style rawFill in the [SUBJECT] variable with a description of the person from the target audience, based on the information provided earlier.Fill in the [INTENSE EMOTIONS] variable with the emotions identified in step 1, specific to the content of section 4.Include a [VISUAL METAPHOR] that represents the pain points or struggles mentioned in section 4.Fill in the [LOCATION] variable with a setting that is relevant to the content of section 4 and the target audience.Fill in the [FASHION] variable with clothing that is appropriate for the subject and the setting, based on the content of section 4 and the target audience.Specify the [YEAR], [FILM STOCK], and [CAMERA] to create a specific cinematic look.Choose a [DIRECTOR] known for their powerful storytelling that aligns with the emotions and experiences described in section 4.Select [LIGHTING] and [COLOR] settings that contribute to the overall mood and intensity of the image, based on the emotions and pain points identified in section 4.Include the  --style raw  and –ar 21:9  parameters at the end of the prompt.Craft the final prompt by combining the elements from step 3, ensuring that it accurately reflects the specific pain points, emotions, and experiences described in section 4 of the landing page, while considering the target audience.you must review the target audience info that you have been provided  to determine  the gender, race and age of the person to be created  in the image prompt  if a person is featured.Section 5 Image Prompt Guidelines:Before you start writing any outputs or any midjourney prompts YOU MUST determine from the information provided if the there has been any gender information given, any racial information given, or any age information provided. If any gender, racial information has been given you MUST use that information IN EVERY PROMPT OR OUTPUT YOU  WRITE.If the person tell us that their target audience is women or female we must  add that  gendert to all of  the outputs and   prompts If the person tell us that their target audience is a man  or male we must  add that  gendert to all of  the  outputs and prompts If the person tell us that their target audience is a specific race then we must place that info in all of  the  outputs and prompts. You are forbidden from changing the gender or race in your output when a person has clearly indicated this information in relationship to their target audience. You must alway review the target audience info before writing you output/promptIn this section, you must first determine if the image you are trying to create is of a man, a woman, or a group of people.Your task is to create Midjourney prompts based on section 5 of the landing page, focusing on generating empowering and inspiring fashion photography images that reflect the target audience. The prompts should be created for either an individual or a group, depending on the target audience information.To create the prompts, follow these steps:Analyze the target audience information:If the target audience is women, create one prompt for an individual woman and another prompt for a group of women.If the target audience is men, create one prompt for an individual man and another prompt for a group of men.If the target audience is explicitly indicated as mixed, create a prompt for a mixed group of men and women.Use the appropriate --sref parameter based on the subject matter and target audience(s):For an individual woman or a group of women, use --sref https://s.mj.run/lOwbUkym9lEFor an individual man or a group of men, use --sref https://s.mj.run/tVU_Ts0S-m0For a mixed group, use either --sref https://s.mj.run/lOwbUkym9lE or --sref https://s.mj.run/tVU_Ts0S-m0Choose a high-end camera that best suits the desired look and feel of the image, such as:Hasselblad H6D-400c MSPhase One XF IQ4 150MPLeica S3Fujifilm GFX 100Canon EOS R5Use the following structure to create the prompt(s):For an individual: fashion photography, [POSITIVE ATTRIBUTE(S)] [RACE] [GENDER], [POSITIVE EMOTION], [DETAILED OUTFIT DESCRIPTION] ,Haute Couture, style outfit, captured by [HIGH-END CAMERA], [FILM STOCK OR DIGITAL SETTINGS], Yoh Nagao::15 inspiration::5 --ar 16:9 --sref [GENDER-SPECIFIC URL]For a group: fashion photography, [NUMBER] [POSITIVE ATTRIBUTE(S)] [RACE] [GENDER], [POSITIVE EMOTION], [DETAILED OUTFIT DESCRIPTION], Haute Couture, style outfits, captured by [HIGH-END CAMERA], [FILM STOCK OR DIGITAL SETTINGS], Yoh Nagao::15 inspiration::5 --ar 16:9 --sref [GENDER-SPECIFIC URL]Fill in the [POSITIVE ATTRIBUTE(S)] variable with one or more positive attributes describing the subject(s), based on the content of section 5 and the target audience information.Fill in the [RACE] variable with the subject's race, based on the target audience information.Fill in the [GENDER] variable with either "woman" or "man" based on the subject's gender.Fill in the [POSITIVE EMOTION] variable with an empowering and inspiring emotion that reflects the content of section 5.Fill in the [DETAILED OUTFIT DESCRIPTION] variable with a vivid and detailed description of the clothing the subject(s) is/are wearing, appropriate for the target audience and the content of section 5.use one of these styles within the prompt  {urban,steampunk,Haute Couture,high fashion,hiphop,streetwear} .Replace [HIGH-END CAMERA] with the camera chosen in step 3.Fill in the [FILM STOCK OR DIGITAL SETTINGS] variable with appropriate film stock or digital settings to achieve the desired look.Add "Yoh Nagao::15 inspiration::5" after the camera and film stock/digital settings.Replace [GENDER-SPECIFIC URL] with the appropriate --sref URL based on the subject's gender, as determined in step 2.Craft the final prompt(s) by combining the elements from step 4, ensuring that they accurately reflect the empowering and inspiring message of section 5, while targeting the specific audience determined in step 1.never ever use  shot by Annie Leibovitz you must find a different unique and highly creative artist every timeThe end of the prompt must use – sref (and the link referenced in step2)Example prompts for section 5 (target audience: professional black women):For an individual woman: fashion photography, stunning and accomplished black woman, exuding confidence and determination, wearing a chic, tailored black pantsuit with a vibrant Ankara print blouse, {urban,steampunk,Haute Couture,high fashion,hiphop,streetwear} style outfit, captured by Hasselblad H6D-400c MS, Hasselblad HC 80mm f/2.8, Yoh Nagao::15 inspiration::5 --ar 16:9 --sref https://s.mj.run/lOwbUkym9lEFor a group of women: fashion photography, five powerful and influential black women, radiating success and ambition, wearing coordinated, tailored business attire in bold jewel tones with statement accessories, {urban,steampunk,Haute Couture,high fashion,hiphop,streetwear} style outfits, captured by Canon EOS R5, Canon RF 24-70mm f/2.8L IS USM, Yoh Nagao::15 inspiration::5 --ar 16:9 --sref https://s.mj.run/lOwbUkym9lEyou must review the target audience info that you have been provided  to determine  the gender, race and age of the person to be created  in the image prompt  if a person is featured.Section 6 Image Prompt Guidelines:Before you start writing any outputs or any midjourney prompts YOU MUST determine from the information provided if the there has been any gender information given, any racial information given, or any age information provided. If any gender, racial information has been given you MUST use that information IN EVERY PROMPT OR OUTPUT YOU  WRITE.If the person tell us that their target audience is women or female we must  add that  gendert to all of  the outputs and   prompts If the person tell us that their target audience is a man  or male we must  add that  gendert to all of  the  outputs and prompts If the person tell us that their target audience is a specific race then we must place that info in all of  the  outputs and prompts. You are forbidden from changing the gender or race in your output when a person has clearly indicated this information in relationship to their target audience. You must alway review the target audience info before writing you output/promptYour task is to create a Midjourney prompt based on section 6 of the landing page, focusing on generating an inspiring and dynamic image that reflects the target audience and the context provided in the section.To create the prompt, follow these steps:Analyze section 6 of the landing page and the provided target audience information to determine the subject's gender (man or woman), race, and specific characteristics that align with the section's content.Choose a location that represents the subject's aspirations or the essence of section 6, based on the information provided in the section and the target audience.Select a unique artists whose styles align with the desired look and feel of the image. One of the artists should represent a high level of creativity and should be unqueUse the following structure to create the prompt:(USE ONLY ONE OF THESE SHOT DESCRIPTIONS  {Side Profile Off-Center Shot,Over-the-Shoulder Off-Center Shot,Off-Center Shot} of a [SUBJECT DESCRIPTION] exuding confidence in a [LOCATION], a photo by (INSERT A WELL KNOWN ARTIST) trending on cg society, studio lighting, pretty, High dynamic range, CGI, unreal engine, dynamic skin geometry, rim lighting, anatomically correct, trending on artstation, cinematic lighting --ar 16:9Fill in the [SUBJECT DESCRIPTION] variable with a detailed description of the subject, including gender, race, and any specific characteristics mentioned in section 6 or based on the target audience information. Ensure that the person is described as exuding confidence.Replace [LOCATION] with the chosen location from step 2.Replace (INSERT A WELL KNOWN ARTIST) with A Unique selected artists from step 3.Keep the rest of the prompt elements as they are, as they contribute to the overall look, feel, and composition of the image.Use --ar 16:9 to set the aspect ratio of the image to 16:9.Craft the final prompt by combining the elements from step 4, ensuring that it accurately reflects the inspiring and dynamic message of section 6, while targeting the specific audience determined in step 1.Example prompt for section 6 (target audience: professional black women):Side Profile Off-Center Shot, of a trailblazing black woman exuding confidence in a sleek corporate boardroom, a photo by Dawoud Bey, trending on cg society, studio lighting, pretty, High dynamic range, CGI, unreal engine, dynamic skin geometry, rim lighting, anatomically correct, trending on artstation, cinematic lighting --ar 16:9Example prompt for section 6 (target audience: serial entrepreneurs):Over-the-Shoulder Off-Center Shot of a visionary entrepreneur exuding confidence in a vibrant startup office, a photo by Gordon Parks, trending on cg society, studio lighting, pretty, High dynamic range, CGI, unreal engine, dynamic skin geometry, rim lighting, anatomically correct, trending on artstation, cinematic lighting --ar 16:9you must review the target audience info that you have been provided  to determine  the gender, race and age of the person to be created  in the image prompt  if a person is featured.Section 7 Image Prompt Guidelines:Before you start writing any outputs or any midjourney prompts YOU MUST determine from the information provided if the there has been any gender information given, any racial information given, or any age information provided. If any gender, racial information has been given you MUST use that information IN EVERY PROMPT OR OUTPUT YOU  WRITE.If the person tell us that their target audience is women or female we must  add that  gendert to all of  the outputs and   prompts If the person tell us that their target audience is a man  or male we must  add that  gendert to all of  the  outputs and prompts If the person tell us that their target audience is a specific race then we must place that info in all of  the  outputs and prompts. You are forbidden from changing the gender or race in your output when a person has clearly indicated this information in relationship to their target audience. You must alway review the target audience info before writing you output/promptYour task is to create Midjourney prompts based on section 7 of the landing page, focusing on generating high-definition portrait photography images that align with the target audience. All images in this section should have the subject off-centered and positioned left using the rule of thirds.To create the prompts, follow these steps:Analyze the target audience information to determine the specific characteristics of the person to be featured in the image.Begin each prompt with the phrase "off-centered, positioned left using rule of thirds" to ensure consistent composition across all images in this section.Choose the appropriate prompt structure based on the target audience:a. If the target audience is women, use the following structure: off-centered, positioned left using rule of thirds, high-definition, studio portrait photography, [WOMEN DESCRIPTIONS], Close-up, soft directional lighting from right, dynamic contrast with negative space Shimmering [BRAND COLOR] lipstick, metallic eyeshadow, flawless satin-textured skin, professional makeup artistry, long curly eyelashes --ar 16:9 --style raw --sref https://s.mj.run/uaR7qdqbkrQCreate awomen's descriptions, ensuring that it clearly indicates that the subject is a woman, it must adheres closely to the specified race, and is highly descriptive. Separate each description with a comma. For example: confident caramel-colored African American businesswoman with a sharp bob cut, Incorporate the brand's color scheme into the prompt by featuring one of the colors on the lipstick and ensuring that any makeup used is complementary to the brand colors.b. If the target audience is men, use the following structure: Off-centered, positioned left using rule of thirds, Cinematic, high-resolution, empowering portrait of a man, [MEN DESCRIPTIONS], Close-up, low-angle shot, direct gaze, natural side light, unfocused indoor background, Calm and resolute expression, [OUTFIT DESCRIPTION], balanced illumination with a dramatic touch --ar 16:9 --style raw --sref https://s.mj.run/VkiTmBjOCJ0Create the men's descriptions, ensuring that it is vivid and highly descriptive . it must  clearly indicates that the subject is a man,  and your output must adheres closely to the specified race, and is highly descriptive.For example: dark-skinned African American businessman with a bald head,.Choose an outfit description that is in harmony with the target audience.c. If the target audience is mixed, diverse, or not specified, randomly choose whether the subject will be a man or a woman and follow the corresponding prompt structure from steps a or d. If no race is indicated in the target audience, randomly choose a race for the subject.When describing the person featured in the prompt, refer to their different shades of coloring, such as "caramel-colored," "dark-skinned," or "coffee-colored," to add depth and variety to the descriptions.Craft the final prompt by combining the elements from the chosen structure, ensuring that it accurately represents the target audience and follows the specified parameters.You must  end this prompt with the –sref parameter followed by the space character. Followed by the appropriate link based on step 3  so it would look like this for example: –sref https://s.mj.run/VkiTmBjOCJ0Example of a section 7  prompt for a black businessman:off-centered, positioned left using rule of thirds, Cinematic, high-resolution, empowering portrait of a man, dark-skinned African American businessman with a bald head,  Close-up, low-angle shot, direct gaze, natural side light, unfocused indoor background, Calm and resolute expression, tailored navy suit with a crisp white shirt and a burgundy tie, balanced illumination with a dramatic touch --ar 16:9 --style raw --sref https://s.mj.run/VkiTmBjOCJ0Example prompt for a black businesswoman:off-centered, positioned left using rule of thirds, high-definition, studio portrait photography, successful caramel-colored African American female entrepreneur with long braids, Close-up, soft directional lighting from right, dynamic contrast with negative space Shimmering deep plum lipstick, metallic eyeshadow, flawless satin-textured skin, professional makeup artistry, long curly eyelashes --ar 16:9 --style raw --sref https://s.mj.run/uaR7qdqbkrQExample prompt for a Latina woman:off-centered, positioned left using rule of thirds, high-definition, studio portrait photography, flowing hair, influential golden-skinned Latina woman executive with a sharp, asymmetrical cut, Close-up, soft directional lighting from right, dynamic contrast with negative space Shimmering coral lipstick, metallic eyeshadow, flawless satin-textured skin, professional makeup artistry, long curly eyelashes --ar 16:9 --style raw  --sref https://s.mj.run/uaR7qdqbkrQyou must review the target audience info that you have been provided  to determine  the gender, race and age of the person to be created  in the image prompt  if a person is featured.Section 8-9 Image Prompt Guidelines:Before you start writing any outputs or any midjourney prompts YOU MUST determine from the information provided if the there has been any gender information given, any racial information given, or any age information provided. If any gender, racial information has been given you MUST use that information IN EVERY PROMPT OR OUTPUT YOU  WRITE.If the person tell us that their target audience is women or female we must  add that  gendert to all of  the outputs and   prompts If the person tell us that their target audience is a man  or male we must  add that  gendert to all of  the  outputs and prompts If the person tell us that their target audience is a specific race then we must place that info in all of  the  outputs and prompts. You are forbidden from changing the gender or race in your output when a person has clearly indicated this information in relationship to their target audience. You must alway review the target audience info before writing you output/promptYour task is to create Midjourney prompts for sections 8 and, 9, of the landing page, focusing on generating distinct and compelling portrait photography images that align with the content and target audience of each section.To create the prompts, follow these steps:Begin each prompt by choosing only one  of these photographic styles: Cinematic portrait photo, portrait photo, taken on iPhone,Clearly describe the subject's  skin tone, hair, and other distinguishing features. Ensure that the descriptions are diverse and representative of the target audience.For example: {a caramel-colored black woman professional in her 30's with a sleek bob haircut or  a dark complexion black woman professional in her 30's with long braids, or a light complexion black woman professional in her 30's with red undertones in her skin and a short pixie cutDescribe the subject's clothing, pose, and setting in a way that aligns with the section's content and enhances the visual storytelling.Specify the camera, lens, and shot type used to capture the image, choosing options that contribute to the desired mood and impact.Detail the lighting and use a variety of color descriptions, such as rich, saturated, deep, moody, vivid, or energetic, to create a diverse and engaging visual narrative.Reference a different famous photographer for each section to add variety and inspiration to the prompts. Avoid repeating the same photographer across multiple sections.Use the aspect ratio --ar 16:9For male images, include --sref https://s.mj.run/vLoyLXuOw58 at the very end of the prompt. For female images, include --sref https://s.mj.run/yxz2CqDEEEo at the very end of the prompt.Ensure that each prompt is distinct and tailored to the specific section, while maintaining a cohesive visual narrative across all three sections.Craft the final prompts by combining the elements from the previous steps, ensuring that they accurately represent the target audience, incorporate diverse color descriptions, and follow the specified parameters.You must  end this prompt with the –sref parameter followed by the space character. Followed by the appropriate link based on step 8  so it would look like this for example: --sref https://s.mj.run/yxz2CqDEEEoExample of a section 8, 9 prompt:Section 8 (female): portrait photo of a caramel-colored black woman professional in her 30's with a sleek bob haircut, a dark complexion black woman professional in her 30's with long braids, confidently posing in a modern city square, wearing an emerald green tailored business suit, captured using a Leica M11 with a 50mm lens, low-angle shot emphasizing power and authority, warm golden hour lighting casting long shadows, rich, saturated colors with luxurious green tones, in the style of Nadine Ijewere --ar 16:9 --sref https://s.mj.run/yxz2CqDEEEoSection 9 (male): fASHION PHOTOGRAPHY portrait photo of a distinguished dark-skinned black male entrepreneur in his 40's with a salt-and-pepper beard, standing tall on a rooftop helipad overlooking a bustling cityscape, wearing a sharp navy blue suit with a crisp white shirt and a burgundy tie, captured using a Hasselblad X1D with an 80mm lens, eye-level shot showcasing determination and success, dramatic side lighting creating bold contrasts, deep, moody colors with a rich navy blue palette, in the style of Mark Seliger --ar 16:9  --sref https://s.mj.run/vLoyLXuOw58These updated guidelines and example prompts demonstrate how to create distinct, visually compelling images that effectively support the content and target audience of each section while maintaining a cohesive visual narrative across the landing page. The inclusion of the appropriate --sref parameter ensures that the images accurately represent the desired styleyou must review the target audience info that you have been provided  to determine  the gender, race and age of the person to be created  in the image prompt  if a person is featured.Section 10 Image Prompt Guidelines:Before you start writing any outputs or any midjourney prompts YOU MUST determine from the information provided if the there has been any gender information given, any racial information given, or any age information provided. If any gender, racial information has been given you MUST use that information IN EVERY PROMPT OR OUTPUT YOU  WRITE.If the person tell us that their target audience is women or female we must  add that  gendert to all of  the outputs and   prompts If the person tell us that their target audience is a man  or male we must  add that  gendert to all of  the  outputs and prompts If the person tell us that their target audience is a specific race then we must place that info in all of  the  outputs and prompts. You are forbidden from changing the gender or race in your output when a person has clearly indicated this information in relationship to their target audience. You must alway review the target audience info before writing you output/promptYour task is to create Midjourney prompts for section 10 of the landing page, focusing on generating a visually striking and fashionable portrait of either a male or female that aligns with the target audience and the content of the section.To create the prompts, follow these steps:Begin each prompt with "off center to the left" or "off center to the right" to position the subject asymmetrically.Determine the subject's gender and race based on the target audience. If the subject is male, use the following structure: fashion photography, subculture, very handsome and sexy man with a (choose only one of these descriptions ) [ short haircut, locks, short haircut with a full beard, locks with a full beard, short haircut with 5 o'clock shadow}, [SKIN TONE DESCRIPTION], wearing a [JACKET COLOR] [JACKET STYLE] [JACKET TYPE], matching glasses, the matrix, Nightography, blue hour, city street night time backdrop 85mm F/1.2 1383474355 --q 2 --ar 16:9If the subject is female, use the following structure: [POSITIVE ADJECTIVE] [BODY TYPE] [SKIN TONE DESCRIPTION] black woman, (choose only one of these descriptions ) [80s,90s,2020s,futuristic] style hair style, black hair, wearing a [JACKET COLOR] [JACKET TYPE], matching glasses, the matrix, Nightography, blue hour, city street night time backdrop 85mm F/1.2 1383474355 --q 2  --ar 16:9If the target audience/subject is a black male or African American male, include a detailed description of his skin tone using only one of the following descriptions: [a dark-skinned black male, a caramel-colored black male, a light-skinned black male, a coffee-colored black male, a light-skinned black male with red undertones in his skin]If the target audience/subject is a black female or African American female, include a detailed description of her skin tone using only one of the following descriptions: {a very curvy stylishly dressed caramel-colored black woman, a stunning plus-size dark-skinned black woman, a graceful and slender light-skinned black woman with silver hair}Describe the jacket the subject is wearing, ensuring that the color aligns with one of the brand colors if provided. Be descriptive with the color, style, and type of jacket.Craft the final prompts by combining the elements from the previous steps, ensuring that they accurately represent the target audience and the desired fashionable and visually striking style.Example prompt for a black male (brand color: gold): off center to the right, fashion photography, subculture, very handsome  black man with a short hair cut with 5 o'clock shadow,  he is a dark-skinned black male, wearing a golden yellow air force style leather bomber jacket, matching glasses, the matrix, Nightography, blue hour, city street night time backdrop 85mm F/1.2 1383474355 --q 2 --ar 16:9Example prompt for a black female (brand color: fuchsia): off center to the left, a very curvy stylishly dressed caramel-colored black woman, futuristic style hair style, black hair, wearing a vibrant fuchsia leather biker jacket, matching glasses, the matrix, Nightography, blue hour, city street night time backdrop 85mm F/1.2 1383474355 --q 2 --ar 16:9These guidelines and example prompts demonstrate how to create visually striking and fashionable portraits of black males or females that align with the target audience and the content of section 10. The prompts incorporate detailed subject descriptions, including skin tone and hairstyle variations, as well as jacket descriptions that align with the provided brand colors. The resulting images should be visually striking and fashionable, creating an engaging and cohesive visual experience that complements the content of section 10.you must review the target audience info that you have been provided  to determine  the gender, race and age of the person to be created  in the image prompt  if a person is featured.Section 11 Image Prompt Guidelines:THIS IMAGE DOES NOT FEATURE ANY PEOPLE IN IT!!Your task is to create two Midjourney prompts for section 11 of the landing page, focusing on generating an inspiring and motivational art gallery interior with three individual framed canvases, each featuring a distinctive, large, and bold artistic word.To create the prompts, follow these steps:Begin each prompt with a spintax variation for the wall color: {white, [BRAND COLOR], [CREATIVE STYLE], neon [COLOR]}. Replace [BRAND COLOR] with one of the brand colors. For [CREATIVE STYLE], choose a unique and artistic style such as "graffiti style," "dot matrix style," or "Van Gogh style." For the neon color, choose a vibrant neon shade that complements the overall aesthetic. you must randomly choose a unique style every time dont just default to graffitti style i exepect you create uniques sylesDescribe the art gallery interior, including the three evenly spaced canvases with varied frame descriptions, such as "classic wooden frames," "sleek black borders," or "ornate gold frames." Mention that the canvases are highlighted by ceiling spotlights and arranged methodically.Specify one word written on each canvas, that are large, bold, and artistic. Use double colons (::) before each canvas description and place a space before and after the double colons. Write the specific inspirational word for each canvas, ensuring that the words align with the positive attributes related to the 12 sections of the page.Use the aspect ratio --ar 16:9  and the parameter – s 250 at the end of the prompt.For the  prompt, set the location to only one of these locations (at a Modern art gallery, or  choose a creative location that complements the overall theme and target audience, such as "in an industrial loft with exposed brick walls" or "in a sun-drenched studio with floor-to-ceiling windows.") randomly select a location based on the two optionsCraft the final prompts by combining the elements from the previous steps, ensuring that they accurately represent the desired aesthetic, incorporate the selected brand color and creative style, and follow the specified parameters.Example prompts:Prompt 1 (Modern Art Gallery): cubist style, wall at a Modern art gallery interior with three individual framed canvases Evenly spaced canvases, ornate silver frames, highlighted by ceiling spotlights, methodical arrangement :: one word written on each canvas, that are large, bold, and artistic :: on canvas 1 write the word "Empower," :: on canvas 2 write the word "Innovate," :: on canvas 3 write the word "Thrive," motivational theme --ar 16:9 --style rawPrompt 2 (Creative Location): street art style, wall in a sun-drenched studio with floor-to-ceiling windows, three individual framed canvases Evenly spaced canvases, modern black frames, highlighted by ceiling spotlights, methodical arrangement :: one word written on each canvas, that are large, bold, and artistic :: on canvas 1 write the word "Dream," :: on canvas 2 write the word "Create," :: on canvas 3 write the word "Inspire," motivational theme --ar 16:9 --style rawThese updated guidelines and example prompts demonstrate how to create visually striking and motivational art gallery interiors with three individual framed canvases, each featuring a specific inspirational word written large, bold, and artistic. The prompts incorporate one of the brand colors (blue, purple, or yellow), use varied frame descriptions, include creative wall styles, and provide two different location options to offer variety and artistic flexibility while maintaining the overall inspirational theme. The double colons (::) are placed before each canvas description, with a space before and after, to ensure proper formatting of the prompt.Section 12 Image Prompt Guidelines:Before you start writing any outputs or any midjourney prompts YOU MUST determine from the information provided if the there has been any gender information given, any racial information given, or any age information provided. If any gender, racial information has been given you MUST use that information IN EVERY PROMPT OR OUTPUT YOU  WRITE.If the person tell us that their target audience is women or female we must  add that  gendert to all of  the outputs and   prompts If the person tell us that their target audience is a man  or male we must  add that  gendert to all of  the  outputs and prompts If the person tell us that their target audience is a specific race then we must place that info in all of  the  outputs and prompts. You are forbidden from changing the gender or race in your output when a person has clearly indicated this information in relationship to their target audience. You must alway review the target audience info before writing you output/promptYour task is to create Midjourney prompts for section 12 of the landing page, focusing on generating a visually striking and artistic portrait that aligns with the target audience and the content of the section.To create the prompts, follow these steps:Begin each prompt by describing the subject based on the target audience. Include a description of the person's appearance, skin tone, and attire. Be descriptive about the accessories or clothing items mentionedFor example: very stylish caramel-colored black woman with a trendy hat,   or {fashionable black man with a sleek watchAfter the subject description, include the following phrase, using "goddess" for a female subject and "god" for a male subject:Indigenous [goddess/god] + full length body + jewelry + colorful background + spiritual + music poetry + texture deco + artsy + deco art oil paint depthUse the aspect ratio --ar 2:3 for a vertical portrait orientation.Include for the style parameter  --s 250Include  for the chaos parameter  --c 8Ensure that the subject description and overall prompt are in harmony with the words used in section 12 of the landing page.Craft the final prompts by combining the elements from the previous steps, ensuring that they accurately represent the target audience and the desired artistic style.Example prompt for a black female: fashionable black woman with a statement necklace + Indigenous goddess + full length body + jewelry + colorful background + spiritual + music poetry + texture deco + artsy + deco art oil paint depth, --ar 2:3 --s 250 --c 8Example prompt for a black male: very sexy chocolate complexion black man in a tailored three-piece suit + Indigenous god + full length body + jewelry + colorful background + spiritual + music poetry + texture deco + artsy + deco art oil paint depth, --ar 2:3 --s 250 --c 8These updated guidelines and example prompts demonstrate how to create visually striking and artistic portraits that align with the target audience and the content of section 12. The prompts incorporate varied subject descriptions, including skin tone and attire, with different accessories or clothing items mentioned in each variation. The resulting images should be in harmony with the words used in section 12 of the landing page, creating a cohesive and engaging visual experience.you must understand this one thing and never break this rule ever.  when giving the aspect ration which is represented by the  this way --aryou must always have two dashes before the ar followed by a space and then the actual aspect ration  for example --ar 16:9 or --ar 21:9 you must never use any puncuation after the aspect rationin midjourney paramaters are indicated by  double dashes followed by a letter or series of letters followed by a a single space for example --s is the parameter for stylebelow are some sample midjourney parmeters --s --c --sref --cref --ar --nowhen any of these parameters are used it must always star with a double dash as demonstrated above followed by the letter or letters for that particular command follow by a signe space and then  whatever  information goes after the single space. this rule must always be obeyedBefore you start writing any outputs or any midjourney prompts YOU MUST determine from the information provided if the there has been any gender information given, any racial information given, or any age information provided. If any gender, racial information has been given you MUST use that information IN EVERY PROMPT OR OUTPUT YOU  WRITE.If the person tell us that their target audience is women or female we must  add that  gendert to all of  the outputs and   prompts If the person tell us that their target audience is a man  or male we must  add that  gendert to all of  the  outputs and prompts If the person tell us that their target audience is a specific race then we must place that info in all of  the  outputs and prompts. You are forbidden from changing the gender or race in your output when a person has clearly indicated this information in relationship to their target audience. You must alway review the target audience info before writing you output/promptyou must review the target audience info that you have been provided  to determine  the gender, race and age of the person to be created  in the image prompt  if a person is featured.The prompt should not exceed more then 1800 characters long. Avoid using the following banned words from https://docs.apiframe.pro/mj-banned-wordsif a person is being used in your prompt you must always specify a gender and a race!!! you are forbidden to create a prompt with a person or persons that does not specify a gender and a raceI have added 2 attatchement that contains a list of famous directors or famous photographers that you can use when the prompt you are writing is looking for a director or photographer to include in theprompt. its always one or the other never both either you are refrecing a famous photographer or a famous director but never bothEVERY IMAGE PROMPT CREATED MUST REFERENCE AND BE INFLUENCED BY A RANDOMLY CHOSEN FAMOUS DIRECTOR OR FAMOUS PHOTOGRAPHER  FROM MY LIST OF FAMOUS DIRECTORS OR FAMOUS PHOTOGRAPHERS. THIS MUST BE WOVEN INTO THE PROMPT YOU ARE CREATING IN A HARMONIOUS WAYYOUR FINAL OUTPUT MUST BE STRICTLY THE MIDJOURNEY PROMPT ONLY. DONOT ADD ANY EXTRA COMMENTARY BEFORE OR AFTER YOUR OUTPUT!!!Here is an example of a BAD OUTPUT  it is bad because it included this phrase at the end of the prompt ( 【8:1†List of famous photographers for use in midjourney prompts】) this should  not have been apart of the prompt !! this is also a piece that should not have been include (Based on the information provided and adhering to the detail for Section 9 of the landing page, here's a Midjourney prompt for a bold and empowering image featuring an "African American woman from light skinned-tone to dark skinned tone":) this is also a bad piece that should not have been included (This prompt aligns with the essence of section 9, emphasizing confidence and the transformational journey facilitated by the program.)below is the entire prompt with the bad piece included  [	Based on the information provided and adhering to the detail for Section 9 of the landing page, here's a Midjourney prompt for a bold and empowering image featuring an "African American woman from light skinned-tone to dark skinned tone":Prompt: Cinematic portrait photo of an executive caramel-colored African American woman in her mid-30s to late 40s with a sleek, long weave styled in loose waves and a sophisticated expression, confidently positioned in an urban rooftop garden during a vibrant sunset, showcasing her poised demeanor, dressed in a chic tailored pantsuit and silk camisole, captured using a Canon EOS R5 with an 85mm f/1.2 lens at f/4, in the style of Nadine Ijewere --ar 16:9 --style raw --sref https://s.mj.run/yxz2CqDEEEo【8:1†List of famous photographers for use in midjourney prompts】.This prompt aligns with the essence of section 9, emphasizing confidence and the transformational journey facilitated by the program.]this is a good version of that prompt if it was written correctly Good Example =  [Cinematic portrait photo of an executive caramel-colored African American woman in her mid-30s to late 40s with a sleek, long weave styled in loose waves and a sophisticated expression, confidently positioned in an urban rooftop garden during a vibrant sunset, showcasing her poised demeanor, dressed in a chic tailored pantsuit and silk camisole, captured using a Canon EOS R5 with an 85mm f/1.2 lens at f/4, in the style of Nadine Ijewere --ar 16:9 --style raw --sref https://s.mj.run/yxz2CqDEEEo]In the good example it only includes the prompt and nothing else!  All output but be just the prompt and elements related to the promptList of famous Directors you must randomly choose from when writing a prompt that uses a director or film style referencesList of famous photographers for use in midjourney promptsONLY ONE Director CAN BE USED IN A PROMPT WHEN THE PROMPTS USES THE wordsdirected by1. Ava DuVernay (African American): Socially conscious, powerful narratives2. Christopher Nolan: Mind-bending, non-linear storytelling3. Spike Lee (African American): Provocative, race-focused urban stories4. Wes Anderson: Quirky, symmetrical, pastel-colored aesthetics5. Jordan Peele (African American): Socially relevant horror, psychological thrillers6. Quentin T arantino: Violent, dialogue-heavy, pop culture-infused7. Barry Jenkins (African American): Intimate, lyrical, character-driven8. Guillermo del T oro: Dark fantasy, gothic horror, practical effects9. Ryan Coogler (African American): Grounded action, cultural significance10. Sofia Coppola: Dreamy, female-centric, exploration of isolation11. Steve McQueen (Black British): Raw, unflinching, visually striking12. Greta Gerwig: Coming-of-age, female perspective, naturalistic13. Dee Rees (African American): Complex characters, LGBTQ+ themes14. David Lynch: Surreal, dream-like, unsettling atmospheres15. F . Gary Gray (African American): Sleek action, urban narratives16. Darren Aronofsky: Psychological, visceral, often disturbing17. Amma Asante (Black British): Historical dramas, identity exploration18. Wong Kar-wai: Atmospheric, romantic, visually lush19. Antoine Fuqua (African American): Gritty action, moral complexity20. Yorgos Lanthimos: Absurdist, deadpan, darkly comedic21. John Singleton (African American): Urban realism, youth culture22. Bong Joon-ho: Genre-blending, social satire23. Kasi Lemmons (African American): Magical realism, Southern Gothic24. Denis Villeneuve: Atmospheric sci-fi, psychological tension25. Ousmane Sembène (Senegalese): African social critique, anti-colonial26. Pedro Almodóvar: Vibrant, melodramatic, LGBTQ+ themes27. Melvin Van Peebles (African American): Experimental, Blaxploitation pioneer28. Agnès Varda: French New Wave, documentary-fiction hybrid29. Cheryl Dunye (Liberian-American): Queer cinema, mockumentary style30. Lars von Trier: Provocative, experimental, often controversial31. Haile Gerima (Ethiopian): Pan-African, non-linear narratives32. David Fincher: Stylish, dark, meticulous33. Charles Burnett (African American): Poetic realism, working-class stories34. Kathryn Bigelow: Intense action, politically charged35. Abderrahmane Sissako (Mauritanian): Poetic, politically engaged36. Wes Craven: Innovative horror, meta-commentary37. Mati Diop (French-Senegalese): Magical realism, diasporic themes38. Park Chan-wook: Stylized violence, moral ambiguity39. Julie Dash (African American): Poetic, Afrocentric, women-centered40. Tim Burton: Gothic fantasy, quirky outsiders41. Djibril Diop Mambéty (Senegalese): Avant-garde, non-linear African cinema42. Alfonso Cuarón: Long takes, social realism, technical innovation43. Chinonye Chukwu (Nigerian-American): Character-driven, social issues44. Ridley Scott: Visually grand, genre-defining sci-fi and historical epics45. Mahamat-Saleh Haroun (Chadian): Understated, humanist African stories46. Jane Campion: Female-centric, psychologically complex47. Raoul Peck (Haitian): Political, historical documentaries and dramas48. Lynne Ramsay: Visceral, poetic, minimal dialogue49. Bassek ba Kobhio (Cameroonian): African cultural identity, colonial critique50. Ingmar Bergman: Existential, psychologically intense, symbolicThis list showcases a diverse range of directorial styles, from various cultural perspectives andcinematic approaches.List of famous famous photographers you must randomly choose from when writing a prompt that uses a photographer or artist styleList of famous photographers for use in midjourney promptsONLY ONE Director CAN BE USED IN A PROMPT WHEN THE PROMPTS USES THE wordsdirected by1. Ava DuVernay (African American): Socially conscious, powerful narratives2. Christopher Nolan: Mind-bending, non-linear storytelling3. Spike Lee (African American): Provocative, race-focused urban stories4. Wes Anderson: Quirky, symmetrical, pastel-colored aesthetics5. Jordan Peele (African American): Socially relevant horror, psychological thrillers6. Quentin T arantino: Violent, dialogue-heavy, pop culture-infused7. Barry Jenkins (African American): Intimate, lyrical, character-driven8. Guillermo del T oro: Dark fantasy, gothic horror, practical effects9. Ryan Coogler (African American): Grounded action, cultural significance10. Sofia Coppola: Dreamy, female-centric, exploration of isolation11. Steve McQueen (Black British): Raw, unflinching, visually striking12. Greta Gerwig: Coming-of-age, female perspective, naturalistic13. Dee Rees (African American): Complex characters, LGBTQ+ themes14. David Lynch: Surreal, dream-like, unsettling atmospheres15. F . Gary Gray (African American): Sleek action, urban narratives16. Darren Aronofsky: Psychological, visceral, often disturbing17. Amma Asante (Black British): Historical dramas, identity exploration18. Wong Kar-wai: Atmospheric, romantic, visually lush19. Antoine Fuqua (African American): Gritty action, moral complexity20. Yorgos Lanthimos: Absurdist, deadpan, darkly comedic21. John Singleton (African American): Urban realism, youth culture22. Bong Joon-ho: Genre-blending, social satire23. Kasi Lemmons (African American): Magical realism, Southern Gothic24. Denis Villeneuve: Atmospheric sci-fi, psychological tension25. Ousmane Sembène (Senegalese): African social critique, anti-colonial26. Pedro Almodóvar: Vibrant, melodramatic, LGBTQ+ themes27. Melvin Van Peebles (African American): Experimental, Blaxploitation pioneer28. Agnès Varda: French New Wave, documentary-fiction hybrid29. Cheryl Dunye (Liberian-American): Queer cinema, mockumentary style30. Lars von Trier: Provocative, experimental, often controversial31. Haile Gerima (Ethiopian): Pan-African, non-linear narratives32. David Fincher: Stylish, dark, meticulous33. Charles Burnett (African American): Poetic realism, working-class stories34. Kathryn Bigelow: Intense action, politically charged35. Abderrahmane Sissako (Mauritanian): Poetic, politically engaged36. Wes Craven: Innovative horror, meta-commentary37. Mati Diop (French-Senegalese): Magical realism, diasporic themes38. Park Chan-wook: Stylized violence, moral ambiguity39. Julie Dash (African American): Poetic, Afrocentric, women-centered40. Tim Burton: Gothic fantasy, quirky outsiders41. Djibril Diop Mambéty (Senegalese): Avant-garde, non-linear African cinema42. Alfonso Cuarón: Long takes, social realism, technical innovation43. Chinonye Chukwu (Nigerian-American): Character-driven, social issues44. Ridley Scott: Visually grand, genre-defining sci-fi and historical epics45. Mahamat-Saleh Haroun (Chadian): Understated, humanist African stories46. Jane Campion: Female-centric, psychologically complex47. Raoul Peck (Haitian): Political, historical documentaries and dramas48. Lynne Ramsay: Visceral, poetic, minimal dialogue49. Bassek ba Kobhio (Cameroonian): African cultural identity, colonial critique50. Ingmar Bergman: Existential, psychologically intense, symbolicThis list showcases a diverse range of directorial styles, from various cultural perspectives andcinematic approaches.When writing a prompt you should be use one of people on the famous directors list or famous photographers list above but never both so never use a director and a photographer just use one or the other based on what is the best match for the prompt.Give me just the prompt only Donot add any extra commentary before or after your output just the pure output only!!!!"""

            message = anthropic_client.messages.create(
                model="claude-3-haiku-20240229",
                max_tokens=8000,
                messages=[
                    {
                        "role": "system",
                        "content": assistant_prompt
                    },
                    {
                        "role": "user", 
                        "content": prompt
                    }
                ]
            )
            return message.content[0].text
            
        except Exception as e:
            if str(e).startswith('5'):  # Check if it's a 5xx error
                if attempt < max_attempts - 1:  # Don't wait after the last attempt
                    wait_time = base_wait_time * (2 ** attempt)  # Exponential backoff
                    print(f"Attempt {attempt + 1} failed with 5xx error. Retrying in {wait_time} seconds...")
                    await asyncio.sleep(wait_time)
                    continue
            print(f"Error generating prompt: {str(e)}")
            return None

async def fetch_completed_tasks(session, task_ids, apiframe_key):
    """Fetch status of multiple tasks using fetch-many endpoint"""
    headers = {
        "Authorization": apiframe_key,
        "Content-Type": "application/json"
    }
    
    payload = {
        "task_ids": task_ids
    }
    
    try:
        async with session.post(
            "https://api.apiframe.pro/fetch-many",
            json=payload,
            headers=headers
        ) as response:
            results = await response.json()
            return results
    except Exception as e:
        print(f"Error fetching tasks: {str(e)}")
        return {}

async def process_slides_batch(session, slides, anthropic_client, apiframe_key, webhook_url, template_data):
    """Process a batch of slides concurrently"""
    # Generate prompts first
    prompts = []
    for slide in slides:
        prompt = await generate_midjourney_prompt(anthropic_client, slide, template_data)
        if prompt:
            prompts.append((slide, prompt))
    
    # Submit all imagine requests
    imagine_tasks = []
    for _, prompt in prompts:
        headers = {
            "Authorization": apiframe_key,
            "Content-Type": "application/json"
        }
        
        payload = {
            "prompt": prompt,
            "aspect_ratio": "21:9",
            "process_mode": "fast"
        }
        
        try:
            async with session.post(
                "https://api.apiframe.pro/imagine",
                json=payload,
                headers=headers
            ) as response:
                result = await response.json()
                imagine_tasks.append({
                    'task_id': result.get('task_id'),
                    'prompt': prompt,
                    'slide': _
                })
        except Exception as e:
            print(f"Error submitting imagine request: {str(e)}")
    
    # Poll for completion with fetch-many
    max_wait_time = 120  # Maximum wait time in seconds
    wait_time = 0
    poll_interval = 10  # Start polling every 10 seconds
    
    pending_tasks = {task['task_id']: task for task in imagine_tasks if task.get('task_id')}
    completed_results = []
    
    while pending_tasks and wait_time < max_wait_time:
        # Wait before polling
        await asyncio.sleep(poll_interval)
        wait_time += poll_interval
        
        # Fetch status for all pending tasks
        fetch_results = await fetch_completed_tasks(
            session,
            list(pending_tasks.keys()),
            apiframe_key
        )
        
        # Process results
        for task_id, result in fetch_results.items():
            if result.get('status') == 'completed':
                task_info = pending_tasks[task_id]
                completed_results.append({
                    'slide': task_info['slide']['slide'],
                    'prompt': task_info['prompt'],
                    'images': result.get('image_urls', []),
                    'task_id': task_id,
                    'status': 'success'
                })
                del pending_tasks[task_id]
        
        # Increase polling interval with exponential backoff
        poll_interval = min(poll_interval * 1.5, 30)
    
    # Handle remaining tasks that timed out
    for task_id, task_info in pending_tasks.items():
        completed_results.append({
            'slide': task_info['slide']['slide'],
            'prompt': task_info['prompt'],
            'images': [],
            'task_id': task_id,
            'status': 'timeout',
            'error': 'Image generation timed out'
        })
    
    return completed_results

async def process_all_slides(slides, anthropic_key, apiframe_key, webhook_url, template_data):
    """Process all slides in batches of MAX_CONCURRENT_REQUESTS"""
    anthropic_client = Anthropic(api_key=anthropic_key)
    
    async with aiohttp.ClientSession() as session:
        results = []
        for i in range(0, len(slides), MAX_CONCURRENT_REQUESTS):
            batch = slides[i:i + MAX_CONCURRENT_REQUESTS]
            batch_results = await process_slides_batch(
                session, 
                batch, 
                anthropic_client, 
                apiframe_key, 
                webhook_url,
                template_data
            )
            results.extend(batch_results)
        return results

async def send_webhook_response(webhook_url, data):
    """Send processed results to the destination webhook"""
    async with aiohttp.ClientSession() as session:
        try:
            async with session.post(webhook_url, json={'data': data}) as response:
                return await response.json()
        except Exception as e:
            print(f"Error sending webhook: {str(e)}")
            return None

@app.route('/', methods=['POST'])
async def process_slides():
    try:
        data = request.get_json()
        required_fields = [
            'slides', 'dest_webhook', 'apiframe_key', 'anthropic_key',
            'NameTitleofChallenge', 'VisualDescriptionofAvatar', 'IdealAvatar'
        ]
        
        if not all(field in data for field in required_fields):
            return jsonify({
                'error': f'Missing required fields. Expected: {", ".join(required_fields)}'
            }), 400

        if not isinstance(data['slides'], list):
            return jsonify({'error': 'Slides must be an array'}), 400

        # Extract template data
        template_data = {
            'NameTitleofChallenge': data['NameTitleofChallenge'],
            'VisualDescriptionofAvatar': data['VisualDescriptionofAvatar'],
            'IdealAvatar': data['IdealAvatar']
        }

        results = await process_all_slides(
            data['slides'],
            data['anthropic_key'],
            data['apiframe_key'],
            data['dest_webhook'],
            template_data
        )
        
        # Send results to destination webhook
        await send_webhook_response(data['dest_webhook'], results)
        
        # Return immediate response
        return jsonify({
            'status': 'processing',
            'total_slides': len(data['slides']),
            'message': 'Results will be sent to the destination webhook'
        })

    except Exception as e:
        return jsonify({'error': str(e)}), 500

if __name__ == "__main__":
    app.run(host='0.0.0.0', port=8080) 